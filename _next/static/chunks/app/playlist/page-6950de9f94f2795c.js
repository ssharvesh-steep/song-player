(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[137],{47:(e,t,r)=>{Promise.resolve().then(r.bind(r,1234))},232:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},1142:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(1958).UU)("https://rcofndbwultxfqiwqmst.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjb2ZuZGJ3dWx0eGZxaXdxbXN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5MTk1MDIsImV4cCI6MjA4MjQ5NTUwMn0.pYykBYeJx9_9gu98f1Vi1E_GVoiKhSBNtcr77nxQMmY")},1234:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(5155),s=r(2115),l=r(3321),i=r(1142),n=r(9769),o=r(232),c=r(8340);let d=(0,c.A)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),u=(0,c.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var x=r(4514),m=r(6962),h=r(2149);function g(){let e=(0,l.useSearchParams)().get("id"),[t,r]=(0,s.useState)(null),[c,g]=(0,s.useState)([]),[p,f]=(0,s.useState)(!0),[w,b]=(0,s.useState)(null),[y,j]=(0,s.useState)(new Set),v=(0,n.A)();(0,s.useEffect)(()=>{let t=async()=>{let{data:t,error:a}=await i.N.from("playlists").select("*").eq("id",e).single();if(a){console.error("Error fetching playlist:",a),f(!1);return}r(t);let{data:s,error:l}=await i.N.from("playlist_songs").select("songs(*)").eq("playlist_id",e).order("added_at",{ascending:!0});if(s){let e=s.map(e=>{let t=e.songs,r=t.image_url.startsWith("http")?t.image_url:i.N.storage.from("images").getPublicUrl(t.image_url).data.publicUrl,a=t.audio_url.startsWith("http")?t.audio_url:i.N.storage.from("songs").getPublicUrl(t.audio_url).data.publicUrl;return{...t,image_url:r,audio_url:a}});g(e);let t=new Set;for(let r of e)await (0,h.dU)(r.id)&&t.add(r.id);j(t)}f(!1)};e&&t()},[e]);let N=async e=>{try{b(e.id),await (0,h.o7)(e),j(t=>new Set(t).add(e.id))}catch(e){console.error("Download error:",e),alert("Failed to download song")}finally{b(null)}};return p?(0,a.jsx)("div",{className:"p-8 text-center text-neutral-400",children:"Loading playlist..."}):t?(0,a.jsxs)("div",{className:"h-full w-full overflow-y-auto bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-gradient-to-b from-orange-200 to-gray-50 p-6 pt-10",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-end gap-6",children:[(0,a.jsx)("div",{className:"w-48 h-48 bg-gradient-to-br from-orange-400 to-pink-500 shadow-2xl rounded-lg flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("span",{className:"text-6xl font-bold text-white opacity-50",children:"#"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,a.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider text-neutral-600",children:"Playlist"}),(0,a.jsx)("h1",{className:"text-4xl md:text-6xl font-black text-neutral-800",children:t.title}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium mt-2 line-clamp-2",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-4 text-sm font-medium text-neutral-600",children:[(0,a.jsx)("span",{children:"Created by You"}),(0,a.jsxs)("span",{children:["• ",c.length," songs"]})]})]})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>c.length>0&&v.setSong(c[0]),className:"w-14 h-14 rounded-full bg-orange-500 flex items-center justify-center hover:scale-105 transition shadow-lg shadow-orange-500/30",children:(0,a.jsx)(o.A,{size:28,className:"text-white fill-white ml-1"})}),(0,a.jsx)("button",{className:"text-neutral-400 hover:text-neutral-800 transition",children:(0,a.jsx)(d,{size:32})})]}),(0,a.jsxs)("div",{className:"px-6 pb-24",children:[(0,a.jsxs)("div",{className:"grid grid-cols-[16px_4fr_2fr_minmax(120px,1fr)] gap-4 px-4 py-2 text-sm font-medium text-neutral-500 border-b border-neutral-200 mb-2",children:[(0,a.jsx)("span",{children:"#"}),(0,a.jsx)("span",{children:"Title"}),(0,a.jsx)("span",{className:"hidden md:block",children:"Date Added"}),(0,a.jsx)("span",{className:"text-right",children:(0,a.jsx)(u,{size:16})})]}),(0,a.jsx)("div",{className:"flex flex-col",children:c.map((e,t)=>(0,a.jsxs)("div",{onClick:()=>v.setSong(e),className:"group grid grid-cols-[16px_4fr_2fr_minmax(120px,1fr)] gap-4 px-4 py-3 rounded-md hover:bg-neutral-100 transition items-center cursor-pointer text-sm font-medium text-neutral-600 border border-transparent hover:border-neutral-200",children:[(0,a.jsx)("span",{className:"group-hover:text-orange-500",children:t+1}),(0,a.jsxs)("div",{className:"flex items-center gap-3 overflow-hidden",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded bg-neutral-200 flex-shrink-0 overflow-hidden",children:(0,a.jsx)("img",{src:e.image_url,className:"w-full h-full object-cover",alt:"Art"})}),(0,a.jsxs)("div",{className:"flex flex-col overflow-hidden",children:[(0,a.jsx)("span",{className:"text-neutral-800 truncate font-bold group-hover:text-orange-600 transition",children:e.title}),(0,a.jsx)("span",{className:"text-neutral-400 truncate",children:e.artist})]})]}),(0,a.jsx)("span",{className:"hidden md:block text-neutral-400",children:"Just now"}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-4",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),y.has(e.id)||N(e)},disabled:w===e.id||y.has(e.id),className:`w-8 h-8 rounded-full flex items-center justify-center transition ${y.has(e.id)?"text-orange-500":"text-neutral-300 hover:text-orange-500 opacity-0 group-hover:opacity-100"}`,children:w===e.id?(0,a.jsx)("div",{className:"animate-spin text-orange-500 text-xs",children:"⏳"}):y.has(e.id)?(0,a.jsx)(x.A,{size:16}):(0,a.jsx)(m.A,{size:16})}),(0,a.jsx)("span",{children:"3:45"})]})]},e.id))})]})]}):(0,a.jsx)("div",{className:"p-8 text-center text-neutral-400",children:"Playlist not found."})}function p(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"p-8 text-center text-neutral-400",children:"Loading..."}),children:(0,a.jsx)(g,{})})}},1934:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});var a=r(2115);let s=e=>{let t,r=new Set,a=(e,a)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=a?a:"object"!=typeof s||null===s)?s:Object.assign({},t,s),r.forEach(r=>r(t,e))}},s=()=>t,l={setState:a,getState:s,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(a,s,l);return l},l=e=>{let t=e?s(e):s,r=e=>(function(e,t=e=>e){let r=a.useSyncExternalStore(e.subscribe,a.useCallback(()=>t(e.getState()),[e,t]),a.useCallback(()=>t(e.getInitialState()),[e,t]));return a.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},i=e=>e?l(e):l},2149:(e,t,r)=>{"use strict";r.d(t,{dU:()=>n,ge:()=>o,o7:()=>l,op:()=>i});let a="downloads",s=()=>new Promise((e,t)=>{let r=indexedDB.open("MusicPlayerDB",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(a)||t.createObjectStore(a,{keyPath:"id"})}}),l=async e=>{try{let t=await fetch(e.audio_url),r=await t.blob(),l=await fetch(e.image_url),i=await l.blob(),n=await s(),o=n.transaction([a],"readwrite").objectStore(a),c={id:e.id,title:e.title,artist:e.artist,image_url:e.image_url,audio_url:e.audio_url,audio_blob:r,image_blob:i,downloaded_at:Date.now()};await new Promise((e,t)=>{let r=o.put(c);r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),n.close()}catch(e){throw console.error("Download error:",e),e}},i=async()=>{try{let e=(await s()).transaction([a],"readonly").objectStore(a);return new Promise((t,r)=>{let a=e.getAll();a.onsuccess=()=>t(a.result),a.onerror=()=>r(a.error)})}catch(e){return console.error("Error getting downloads:",e),[]}},n=async e=>{try{let t=(await s()).transaction([a],"readonly").objectStore(a);return new Promise((r,a)=>{let s=t.get(e);s.onsuccess=()=>r(!!s.result),s.onerror=()=>a(s.error)})}catch(e){return!1}},o=async e=>{try{let t=await s(),r=t.transaction([a],"readwrite").objectStore(a);await new Promise((t,a)=>{let s=r.delete(e);s.onsuccess=()=>t(s.result),s.onerror=()=>a(s.error)}),t.close()}catch(e){throw console.error("Delete error:",e),e}}},3321:(e,t,r)=>{"use strict";var a=r(4645);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},4514:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6962:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},8340:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(2115);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:n="",children:o,iconNode:c,...d},u)=>(0,a.createElement)("svg",{ref:u,...i,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:l("lucide",n),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(o)?o:[o]])),o=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...i},o)=>(0,a.createElement)(n,{ref:o,iconNode:t,className:l(`lucide-${s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...i}));return r.displayName=s(e),r}},9769:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1934).v)(e=>({activeSong:void 0,isPlaying:!1,volume:1,setSong:t=>e({activeSong:t,isPlaying:!0}),reset:()=>e({activeSong:void 0,isPlaying:!1}),togglePlay:()=>e(e=>({isPlaying:!e.isPlaying})),setVolume:t=>e({volume:t})}))}},e=>{e.O(0,[958,441,794,358],()=>e(e.s=47)),_N_E=e.O()}]);