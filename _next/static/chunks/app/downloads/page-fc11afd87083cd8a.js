(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{97:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(5155),l=r(2115),s=r(2149),o=r(9769),i=r(6962),n=r(232),c=r(8459);function d(){let[e,t]=(0,l.useState)([]),[r,d]=(0,l.useState)(!0),[u,m]=(0,l.useState)(null),h=(0,o.A)();(0,l.useEffect)(()=>{g()},[]);let g=async()=>{d(!0),t(await (0,s.op)()),d(!1)},w=async e=>{if(confirm("Remove this song from downloads?"))try{m(e),await (0,s.ge)(e),await g()}catch(e){console.error("Delete error:",e),alert("Failed to delete download")}finally{m(null)}};return(0,a.jsx)("div",{className:"bg-neutral-900 rounded-lg h-full w-full overflow-hidden overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)(i.A,{size:28}),"Downloads"]}),(0,a.jsxs)("p",{className:"text-neutral-400 text-sm mt-1",children:[e.length," ",1===e.length?"song":"songs"," downloaded for offline playback"]})]})}),r?(0,a.jsx)("div",{className:"text-white",children:"Loading downloads..."}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(i.A,{size:64,className:"mx-auto text-neutral-600 mb-4"}),(0,a.jsx)("p",{className:"text-neutral-400 text-lg",children:"No downloads yet"}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm mt-2",children:"Download songs from the home page to play them offline"})]}):(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:e.map(e=>(0,a.jsxs)("div",{className:"relative group flex flex-col items-center justify-center rounded-md overflow-hidden gap-x-4 bg-neutral-400/5 hover:bg-neutral-400/10 transition p-3",children:[(0,a.jsxs)("div",{className:"relative aspect-square w-full h-full rounded-md overflow-hidden mb-4 cursor-pointer",onClick:()=>{let t,r;return t=URL.createObjectURL(e.audio_blob),r=URL.createObjectURL(e.image_blob),void h.setSong({id:e.id,title:e.title,artist:e.artist,image_url:r,audio_url:t})},children:[(0,a.jsx)("img",{className:"object-cover w-full h-full",src:URL.createObjectURL(e.image_blob),alt:"Cover"}),(0,a.jsx)("div",{className:"absolute transition opacity-0 rounded-full flex items-center justify-center bg-green-500 p-4 drop-shadow-md right-2 bottom-2 group-hover:opacity-100 hover:scale-110",children:(0,a.jsx)(n.A,{className:"text-black fill-black"})})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center w-full pt-2 gap-x-3",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e.id)},disabled:u===e.id,title:"Remove from downloads",className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center transition text-neutral-400 hover:text-red-500 hover:bg-neutral-700 disabled:opacity-50",children:u===e.id?(0,a.jsx)("div",{className:"animate-spin text-red-500",children:"â³"}):(0,a.jsx)(c.A,{size:18})}),(0,a.jsxs)("div",{className:"flex flex-col items-start min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"font-semibold truncate w-full text-white text-sm",children:e.title}),(0,a.jsx)("p",{className:"text-neutral-400 text-xs w-full truncate",children:e.artist})]})]})]},e.id))})]})})}},232:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},1934:(e,t,r)=>{"use strict";r.d(t,{v:()=>o});var a=r(2115);let l=e=>{let t,r=new Set,a=(e,a)=>{let l="function"==typeof e?e(t):e;if(!Object.is(l,t)){let e=t;t=(null!=a?a:"object"!=typeof l||null===l)?l:Object.assign({},t,l),r.forEach(r=>r(t,e))}},l=()=>t,s={setState:a,getState:l,getInitialState:()=>o,subscribe:e=>(r.add(e),()=>r.delete(e))},o=t=e(a,l,s);return s},s=e=>{let t=e?l(e):l,r=e=>(function(e,t=e=>e){let r=a.useSyncExternalStore(e.subscribe,a.useCallback(()=>t(e.getState()),[e,t]),a.useCallback(()=>t(e.getInitialState()),[e,t]));return a.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},o=e=>e?s(e):s},2149:(e,t,r)=>{"use strict";r.d(t,{dU:()=>i,ge:()=>n,o7:()=>s,op:()=>o});let a="downloads",l=()=>new Promise((e,t)=>{let r=indexedDB.open("MusicPlayerDB",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(a)||t.createObjectStore(a,{keyPath:"id"})}}),s=async e=>{try{let t=await fetch(e.audio_url),r=await t.blob(),s=await fetch(e.image_url),o=await s.blob(),i=await l(),n=i.transaction([a],"readwrite").objectStore(a),c={id:e.id,title:e.title,artist:e.artist,image_url:e.image_url,audio_url:e.audio_url,audio_blob:r,image_blob:o,downloaded_at:Date.now()};await new Promise((e,t)=>{let r=n.put(c);r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),i.close()}catch(e){throw console.error("Download error:",e),e}},o=async()=>{try{let e=(await l()).transaction([a],"readonly").objectStore(a);return new Promise((t,r)=>{let a=e.getAll();a.onsuccess=()=>t(a.result),a.onerror=()=>r(a.error)})}catch(e){return console.error("Error getting downloads:",e),[]}},i=async e=>{try{let t=(await l()).transaction([a],"readonly").objectStore(a);return new Promise((r,a)=>{let l=t.get(e);l.onsuccess=()=>r(!!l.result),l.onerror=()=>a(l.error)})}catch(e){return!1}},n=async e=>{try{let t=await l(),r=t.transaction([a],"readwrite").objectStore(a);await new Promise((t,a)=>{let l=r.delete(e);l.onsuccess=()=>t(l.result),l.onerror=()=>a(l.error)}),t.close()}catch(e){throw console.error("Delete error:",e),e}}},6962:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},8340:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(2115);let l=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:i="",children:n,iconNode:c,...d},u)=>(0,a.createElement)("svg",{ref:u,...o,width:t,height:t,stroke:e,strokeWidth:l?24*Number(r)/Number(t):r,className:s("lucide",i),...!n&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(n)?n:[n]])),n=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...o},n)=>(0,a.createElement)(i,{ref:n,iconNode:t,className:s(`lucide-${l(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...o}));return r.displayName=l(e),r}},8459:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},9168:(e,t,r)=>{Promise.resolve().then(r.bind(r,97))},9769:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1934).v)(e=>({activeSong:void 0,isPlaying:!1,volume:1,setSong:t=>e({activeSong:t,isPlaying:!0}),reset:()=>e({activeSong:void 0,isPlaying:!1}),togglePlay:()=>e(e=>({isPlaying:!e.isPlaying})),setVolume:t=>e({volume:t})}))}},e=>{e.O(0,[441,794,358],()=>e(e.s=9168)),_N_E=e.O()}]);