(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{232:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},1142:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});let s=(0,r(1958).UU)("https://rcofndbwultxfqiwqmst.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjb2ZuZGJ3dWx0eGZxaXdxbXN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5MTk1MDIsImV4cCI6MjA4MjQ5NTUwMn0.pYykBYeJx9_9gu98f1Vi1E_GVoiKhSBNtcr77nxQMmY")},1878:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},1934:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});var s=r(2115);let a=e=>{let t,r=new Set,s=(e,s)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=s?s:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,l={setState:s,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(s,a,l);return l},l=e=>{let t=e?a(e):a,r=e=>(function(e,t=e=>e){let r=s.useSyncExternalStore(e.subscribe,s.useCallback(()=>t(e.getState()),[e,t]),s.useCallback(()=>t(e.getInitialState()),[e,t]));return s.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},i=e=>e?l(e):l},2149:(e,t,r)=>{"use strict";r.d(t,{dU:()=>o,ge:()=>n,o7:()=>l,op:()=>i});let s="downloads",a=()=>new Promise((e,t)=>{let r=indexedDB.open("MusicPlayerDB",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(s)||t.createObjectStore(s,{keyPath:"id"})}}),l=async e=>{try{let t=await fetch(e.audio_url),r=await t.blob(),l=await fetch(e.image_url),i=await l.blob(),o=await a(),n=o.transaction([s],"readwrite").objectStore(s),c={id:e.id,title:e.title,artist:e.artist,image_url:e.image_url,audio_url:e.audio_url,audio_blob:r,image_blob:i,downloaded_at:Date.now()};await new Promise((e,t)=>{let r=n.put(c);r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),o.close()}catch(e){throw console.error("Download error:",e),e}},i=async()=>{try{let e=(await a()).transaction([s],"readonly").objectStore(s);return new Promise((t,r)=>{let s=e.getAll();s.onsuccess=()=>t(s.result),s.onerror=()=>r(s.error)})}catch(e){return console.error("Error getting downloads:",e),[]}},o=async e=>{try{let t=(await a()).transaction([s],"readonly").objectStore(s);return new Promise((r,s)=>{let a=t.get(e);a.onsuccess=()=>r(!!a.result),a.onerror=()=>s(a.error)})}catch(e){return!1}},n=async e=>{try{let t=await a(),r=t.transaction([s],"readwrite").objectStore(s);await new Promise((t,s)=>{let a=r.delete(e);a.onsuccess=()=>t(a.result),a.onerror=()=>s(a.error)}),t.close()}catch(e){throw console.error("Delete error:",e),e}}},3020:(e,t,r)=>{Promise.resolve().then(r.bind(r,6919))},4514:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6919:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(2115),l=r(1142),i=r(9769),o=r(1878),n=r(232),c=r(4514),d=r(6962),u=r(2149);function h(){let[e,t]=(0,a.useState)([]),[r,h]=(0,a.useState)(!0),[m,x]=(0,a.useState)(null),[g,b]=(0,a.useState)(new Set),p=(0,i.A)(),[w,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{l.N.auth.getUser().then(({data:{user:e}})=>f(e)),j();let e=l.N.channel("songs-home-changes").on("postgres_changes",{event:"*",schema:"public",table:"songs"},e=>j()).subscribe();return()=>{l.N.removeChannel(e)}},[]);let j=async()=>{let{data:e,error:r}=await l.N.from("songs").select("*").order("created_at",{ascending:!1});if(!r&&e){let r=e.map(e=>{let t=l.N.storage.from("images").getPublicUrl(e.image_url).data.publicUrl,r=l.N.storage.from("songs").getPublicUrl(e.audio_url).data.publicUrl;return{...e,image_url:t,audio_url:r}});t(r);let s=new Set;for(let e of r)await (0,u.dU)(e.id)&&s.add(e.id);b(s)}h(!1)},v=async e=>{try{x(e.id),await (0,u.o7)(e),b(t=>new Set(t).add(e.id))}catch(e){console.error("Download error:",e),alert("Failed to download song")}finally{x(null)}};return(0,s.jsx)("div",{className:"h-full w-full overflow-hidden overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6 pb-24",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent",children:["Hello, ",w?.email?.split("@")[0]||"Guest"]}),(0,s.jsx)("p",{className:"text-neutral-400 text-sm",children:"Welcome back!"})]}),(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsx)("button",{className:"p-2 rounded-full glass hover:bg-white/10 transition",children:(0,s.jsx)(o.A,{size:20,className:"text-white"})})})]}),(0,s.jsx)("div",{className:"flex gap-3 mb-8 overflow-x-auto pb-2 scrollbar-hide",children:["All","New Artists","Hot Tracks","Editor's Picks"].map((e,t)=>(0,s.jsx)("button",{className:`px-6 py-2 rounded-full text-sm font-medium whitespace-nowrap transition ${0===t?"bg-purple-600 text-white shadow-lg shadow-purple-500/30":"glass text-neutral-300 hover:bg-white/10"}`,children:e},e))}),(0,s.jsxs)("div",{className:"relative w-full h-48 rounded-3xl overflow-hidden mb-8 group cursor-pointer",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-800 to-pink-600 opacity-90 transition group-hover:scale-105 duration-700"}),(0,s.jsxs)("div",{className:"absolute inset-0 p-6 flex flex-col justify-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Feel the Beat"}),(0,s.jsx)("p",{className:"text-purple-100 text-sm max-w-xs mb-4",children:"Explore trending tracks and hidden gems curated just for you."}),(0,s.jsx)("button",{className:"w-fit px-6 py-2 bg-white text-purple-900 rounded-full font-bold text-sm hover:scale-105 transition shadow-lg",children:"Start Listening"})]}),(0,s.jsx)("div",{className:"absolute -right-10 -bottom-10 w-40 h-40 bg-pink-500 rounded-full blur-3xl opacity-30"}),(0,s.jsx)("div",{className:"absolute right-20 top-10 w-20 h-20 bg-purple-400 rounded-full blur-2xl opacity-30"})]}),(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white",children:"Popular"}),(0,s.jsx)("button",{className:"text-sm text-neutral-400 hover:text-white transition",children:"Show all"})]}),r?(0,s.jsx)("div",{className:"text-white",children:"Loading..."}):(0,s.jsx)("div",{className:"flex flex-col gap-3",children:e.map(e=>(0,s.jsxs)("div",{onClick:()=>p.setSong(e),className:"group flex items-center justify-between p-3 rounded-2xl glass hover:bg-white/10 transition cursor-pointer",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative w-14 h-14 rounded-xl overflow-hidden shadow-lg",children:[(0,s.jsx)("img",{className:"object-cover w-full h-full group-hover:scale-110 transition duration-500",src:e.image_url,alt:"Cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition",children:(0,s.jsx)(n.A,{size:16,className:"text-white fill-white"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-white truncate",children:e.title}),(0,s.jsx)("p",{className:"text-neutral-400 text-xs",children:e.artist})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),g.has(e.id)||v(e)},disabled:m===e.id||g.has(e.id),className:`w-9 h-9 rounded-full flex items-center justify-center transition border border-white/10 ${g.has(e.id)?"text-green-400 bg-green-500/10":"text-neutral-400 hover:text-white hover:bg-white/10"}`,children:m===e.id?(0,s.jsx)("div",{className:"animate-spin text-green-500",children:"â³"}):g.has(e.id)?(0,s.jsx)(c.A,{size:16}):(0,s.jsx)(d.A,{size:16})}),(0,s.jsx)("button",{className:"w-9 h-9 rounded-full flex items-center justify-center text-neutral-400 hover:text-white hover:bg-white/10 transition border border-white/10",children:(0,s.jsx)(n.A,{size:16,className:"ml-0.5"})})]})]},e.id))})]})})}},6962:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},8340:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:n,iconNode:c,...d},u)=>(0,s.createElement)("svg",{ref:u,...i,width:t,height:t,stroke:e,strokeWidth:a?24*Number(r)/Number(t):r,className:l("lucide",o),...!n&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(n)?n:[n]])),n=(e,t)=>{let r=(0,s.forwardRef)(({className:r,...i},n)=>(0,s.createElement)(o,{ref:n,iconNode:t,className:l(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...i}));return r.displayName=a(e),r}},9769:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1934).v)(e=>({activeSong:void 0,isPlaying:!1,volume:1,setSong:t=>e({activeSong:t,isPlaying:!0}),reset:()=>e({activeSong:void 0,isPlaying:!1}),togglePlay:()=>e(e=>({isPlaying:!e.isPlaying})),setVolume:t=>e({volume:t})}))}},e=>{e.O(0,[958,441,794,358],()=>e(e.s=3020)),_N_E=e.O()}]);