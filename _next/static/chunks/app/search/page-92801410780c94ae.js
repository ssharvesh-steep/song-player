(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[959],{232:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},1142:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(1958).UU)("https://rcofndbwultxfqiwqmst.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjb2ZuZGJ3dWx0eGZxaXdxbXN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5MTk1MDIsImV4cCI6MjA4MjQ5NTUwMn0.pYykBYeJx9_9gu98f1Vi1E_GVoiKhSBNtcr77nxQMmY")},1878:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},1934:(e,t,r)=>{"use strict";r.d(t,{v:()=>n});var a=r(2115);let l=e=>{let t,r=new Set,a=(e,a)=>{let l="function"==typeof e?e(t):e;if(!Object.is(l,t)){let e=t;t=(null!=a?a:"object"!=typeof l||null===l)?l:Object.assign({},t,l),r.forEach(r=>r(t,e))}},l=()=>t,o={setState:a,getState:l,getInitialState:()=>n,subscribe:e=>(r.add(e),()=>r.delete(e))},n=t=e(a,l,o);return o},o=e=>{let t=e?l(e):l,r=e=>(function(e,t=e=>e){let r=a.useSyncExternalStore(e.subscribe,a.useCallback(()=>t(e.getState()),[e,t]),a.useCallback(()=>t(e.getInitialState()),[e,t]));return a.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},n=e=>e?o(e):o},2149:(e,t,r)=>{"use strict";r.d(t,{dU:()=>s,ge:()=>i,o7:()=>o,op:()=>n});let a="downloads",l=()=>new Promise((e,t)=>{let r=indexedDB.open("MusicPlayerDB",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(a)||t.createObjectStore(a,{keyPath:"id"})}}),o=async e=>{try{let t=await fetch(e.audio_url),r=await t.blob(),o=await fetch(e.image_url),n=await o.blob(),s=await l(),i=s.transaction([a],"readwrite").objectStore(a),c={id:e.id,title:e.title,artist:e.artist,image_url:e.image_url,audio_url:e.audio_url,audio_blob:r,image_blob:n,downloaded_at:Date.now()};await new Promise((e,t)=>{let r=i.put(c);r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),s.close()}catch(e){throw console.error("Download error:",e),e}},n=async()=>{try{let e=(await l()).transaction([a],"readonly").objectStore(a);return new Promise((t,r)=>{let a=e.getAll();a.onsuccess=()=>t(a.result),a.onerror=()=>r(a.error)})}catch(e){return console.error("Error getting downloads:",e),[]}},s=async e=>{try{let t=(await l()).transaction([a],"readonly").objectStore(a);return new Promise((r,a)=>{let l=t.get(e);l.onsuccess=()=>r(!!l.result),l.onerror=()=>a(l.error)})}catch(e){return!1}},i=async e=>{try{let t=await l(),r=t.transaction([a],"readwrite").objectStore(a);await new Promise((t,a)=>{let l=r.delete(e);l.onsuccess=()=>t(l.result),l.onerror=()=>a(l.error)}),t.close()}catch(e){throw console.error("Delete error:",e),e}}},3321:(e,t,r)=>{"use strict";var a=r(4645);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},4514:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},5838:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var a={};r.r(a),r.d(a,{exclude:()=>S,extract:()=>w,parse:()=>x,parseUrl:()=>v,pick:()=>k,stringify:()=>j,stringifyUrl:()=>N});var l=r(5155),o=r(2115),n=r(3321),s=r(1142),i=r(9769);let c="%[a-f0-9]{2}",u=RegExp("("+c+")|([^%]+?)","gi"),d=RegExp("("+c+")+","gi");function f(e,t){if("string"!=typeof e||"string"!=typeof t)throw TypeError("Expected the arguments to be of type `string`");if(""===e||""===t)return[];let r=e.indexOf(t);return -1===r?[]:[e.slice(0,r),e.slice(r+t.length)]}let p=Symbol("encodeFragmentIdentifier");function m(e){if("string"!=typeof e||1!==e.length)throw TypeError("arrayFormatSeparator must be single character string")}function g(e,t){return t.encode?t.strict?encodeURIComponent(e).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`):encodeURIComponent(e):e}function y(e,t){if(t.decode){if("string"!=typeof e)throw TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{var r=e;let t={"%FE%FF":"��","%FF%FE":"��"},a=d.exec(r);for(;a;){try{t[a[0]]=decodeURIComponent(a[0])}catch{let e=function(e){try{return decodeURIComponent(e)}catch{let t=e.match(u)||[];for(let r=1;r<t.length;r++)t=(e=(function e(t,r){try{return[decodeURIComponent(t.join(""))]}catch{}if(1===t.length)return t;r=r||1;let a=t.slice(0,r),l=t.slice(r);return Array.prototype.concat.call([],e(a),e(l))})(t,r).join("")).match(u)||[];return e}}(a[0]);e!==a[0]&&(t[a[0]]=e)}a=d.exec(r)}for(let e of(t["%C2"]="�",Object.keys(t)))r=r.replace(RegExp(e,"g"),t[e]);return r}}return e}function h(e){let t=e.indexOf("#");return -1!==t&&(e=e.slice(0,t)),e}function b(e,t,r){return"string"===r&&"string"==typeof e?e:"function"==typeof r&&"string"==typeof e?r(e):"boolean"===r&&null===e||("boolean"===r&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())?"true"===e.toLowerCase():"boolean"===r&&null!==e&&("1"===e.toLowerCase()||"0"===e.toLowerCase())?"1"===e.toLowerCase():"string[]"===r&&"none"!==t.arrayFormat&&"string"==typeof e?[e]:"number[]"!==r||"none"===t.arrayFormat||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?"number"!==r||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?t.parseBooleans&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())?"true"===e.toLowerCase():t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?Number(e):e:Number(e):[Number(e)])}function w(e){let t=(e=h(e)).indexOf("?");return -1===t?"":e.slice(t+1)}function x(e,t){m((t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...t}).arrayFormatSeparator);let r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,a)=>{if(t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),!t){a[e]=r;return}void 0===a[e]&&(a[e]={}),a[e][t[1]]=r};case"bracket":return(e,r,a)=>{if(t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),!t){a[e]=r;return}if(void 0===a[e]){a[e]=[r];return}a[e]=[...a[e],r]};case"colon-list-separator":return(e,r,a)=>{if(t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),!t){a[e]=r;return}if(void 0===a[e]){a[e]=[r];return}a[e]=[...a[e],r]};case"comma":case"separator":return(t,r,a)=>{let l="string"==typeof r&&r.includes(e.arrayFormatSeparator)?r.split(e.arrayFormatSeparator).map(t=>y(t,e)):null===r?r:y(r,e);a[t]=l};case"bracket-separator":return(t,r,a)=>{let l=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!l){a[t]=r?y(r,e):r;return}let o=null===r?[]:y(r,e).split(e.arrayFormatSeparator);if(void 0===a[t]){a[t]=o;return}a[t]=[...a[t],...o]};default:return(e,t,r)=>{if(void 0===r[e]){r[e]=t;return}r[e]=[...[r[e]].flat(),t]}}}(t),a=Object.create(null);if("string"!=typeof e||!(e=e.trim().replace(/^[?#&]/,"")))return a;for(let l of e.split("&")){if(""===l)continue;let e=t.decode?l.replaceAll("+"," "):l,[o,n]=f(e,"=");void 0===o&&(o=e),n=void 0===n?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?n:y(n,t),r(y(o,t),n,a)}for(let[e,r]of Object.entries(a))if("object"==typeof r&&null!==r&&"string"!==t.types[e])for(let[a,l]of Object.entries(r)){let o=t.types[e],n="function"==typeof o?o:o?o.replace("[]",""):void 0;r[a]=b(l,t,n)}else"object"==typeof r&&null!==r&&"string"===t.types[e]?a[e]=Object.values(r).join(t.arrayFormatSeparator):a[e]=b(r,t,t.types[e]);return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{let r=a[t];return e[t]=r&&"object"==typeof r&&!Array.isArray(r)?function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(r):r,e},Object.create(null))}function j(e,t){if(!e)return"";m((t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t}).arrayFormatSeparator);let r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],a=function(e){switch(e.arrayFormat){case"index":return t=>(r,a)=>{let l=r.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:null===a?[...r,g(t,e)+"["+l+"]"]:[...r,g(t,e)+"["+g(l,e)+"]="+g(a,e)]};case"bracket":return t=>(r,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:null===a?[...r,g(t,e)+"[]"]:[...r,g(t,e)+"[]="+g(a,e)];case"colon-list-separator":return t=>(r,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:null===a?[...r,g(t,e)+":list="]:[...r,g(t,e)+":list="+g(a,e)];case"comma":case"separator":case"bracket-separator":{let t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(a,l)=>void 0===l||e.skipNull&&null===l||e.skipEmptyString&&""===l?a:(l=null===l?"":l,0===a.length)?[[g(r,e),t,g(l,e)].join("")]:[[a,g(l,e)].join(e.arrayFormatSeparator)]}default:return t=>(r,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:null===a?[...r,g(t,e)]:[...r,g(t,e)+"="+g(a,e)]}}(t),l={};for(let[t,a]of Object.entries(e))r(t)||(l[t]=a);let o=Object.keys(l);return!1!==t.sort&&o.sort(t.sort),o.map(r=>{let l=e[r];if(t.replacer&&void 0===(l=t.replacer(r,l))||void 0===l)return"";if(null===l)return g(r,t);if(Array.isArray(l)){if(0===l.length&&"bracket-separator"===t.arrayFormat)return g(r,t)+"[]";let e=l;return t.replacer&&(e=l.map((e,a)=>t.replacer(`${r}[${a}]`,e)).filter(e=>void 0!==e)),e.reduce(a(r),[]).join("&")}return g(r,t)+"="+g(l,t)}).filter(e=>e.length>0).join("&")}function v(e,t){t={decode:!0,...t};let[r,a]=f(e,"#");return void 0===r&&(r=e),{url:r?.split("?")?.[0]??"",query:x(w(e),t),...t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:y(a,t)}:{}}}function N(e,t){var r;let a,l;t={encode:!0,strict:!0,[p]:!0,...t};let o=h(e.url).split("?")[0]||"",n=j({...x(w(e.url),{sort:!1,...t}),...e.query},t);n&&=`?${n}`;let s=(r=e.url,a="",-1!==(l=r.indexOf("#"))&&(a=r.slice(l)),a);if("string"==typeof e.fragmentIdentifier){let r=new URL(o);r.hash=e.fragmentIdentifier,s=t[p]?r.hash:`#${e.fragmentIdentifier}`}return`${o}${n}${s}`}function k(e,t,r){let{url:a,query:l,fragmentIdentifier:o}=v(e,r={parseFragmentIdentifier:!0,[p]:!1,...r});return N({url:a,query:function(e,t){let r={};if(Array.isArray(t))for(let a of t){let t=Object.getOwnPropertyDescriptor(e,a);t?.enumerable&&Object.defineProperty(r,a,t)}else for(let a of Reflect.ownKeys(e)){let l=Object.getOwnPropertyDescriptor(e,a);if(l.enumerable){let o=e[a];t(a,o,e)&&Object.defineProperty(r,a,l)}}return r}(l,t),fragmentIdentifier:o},r)}function S(e,t,r){return k(e,Array.isArray(t)?e=>!t.includes(e):(e,r)=>!t(e,r),r)}let A=function(e,t){let[r,a]=(0,o.useState)(e);return(0,o.useEffect)(()=>{let r=setTimeout(()=>{a(e)},t||500);return()=>{clearTimeout(r)}},[e,t]),r};var C=r(1878);let I=()=>{let e=(0,n.useRouter)(),[t,r]=(0,o.useState)(""),s=A(t,500);return(0,o.useEffect)(()=>{let t=a.stringifyUrl({url:"/search",query:{title:s}});e.push(t)},[s,e]),(0,l.jsxs)("div",{className:"relative mb-6",children:[(0,l.jsx)(C.A,{size:20,className:"absolute top-3 left-3 text-neutral-400"}),(0,l.jsx)("input",{type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"What do you want to listen to?",className:" w-full  bg-neutral-800  text-white rounded-full  pl-10  pr-4  py-2  text-sm  focus:outline-none  focus:ring-2  focus:ring-white/20 placeholder:text-neutral-400 "})]})};var O=r(232),F=r(4514),E=r(6962),P=r(2149);let U=()=>{let e=(0,n.useSearchParams)().get("title"),[t,r]=(0,o.useState)([]),[a,c]=(0,o.useState)(!1),[u,d]=(0,o.useState)(null),[f,p]=(0,o.useState)(new Set),m=(0,i.A)();(0,o.useEffect)(()=>{(async()=>{c(!0);let t=s.N.from("songs").select("*").order("created_at",{ascending:!1});e&&(t=t.ilike("title",`%${e}%`));let{data:a,error:l}=await t;if(!l&&a){let e=a.map(e=>{let t=s.N.storage.from("images").getPublicUrl(e.image_url).data.publicUrl,r=s.N.storage.from("songs").getPublicUrl(e.audio_url).data.publicUrl;return{...e,image_url:t,audio_url:r}});r(e);let t=new Set;for(let r of e)await (0,P.dU)(r.id)&&t.add(r.id);p(t)}else r([]);c(!1)})()},[e]);let g=async e=>{try{d(e.id),await (0,P.o7)(e),p(t=>new Set(t).add(e.id))}catch(e){console.error("Download error:",e),alert("Failed to download song")}finally{d(null)}};return(0,l.jsxs)("div",{className:"flex flex-col gap-y-6 p-6",children:[(0,l.jsx)("h1",{className:"text-white text-3xl font-semibold",children:"Search"}),(0,l.jsx)(I,{}),(0,l.jsx)("div",{className:"flex flex-col gap-y-2 w-full",children:a?(0,l.jsx)("div",{className:"text-neutral-400",children:"Loading..."}):0===t.length?(0,l.jsx)("div",{className:"text-neutral-400",children:"No songs found."}):(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:t.map(e=>(0,l.jsxs)("div",{className:"relative group flex flex-col items-center justify-center rounded-md overflow-hidden gap-x-4 bg-neutral-400/5 hover:bg-neutral-400/10 transition p-3",children:[(0,l.jsxs)("div",{className:"relative aspect-square w-full h-full rounded-md overflow-hidden mb-4 cursor-pointer",onClick:()=>m.setSong(e),children:[(0,l.jsx)("img",{className:"object-cover w-full h-full",src:e.image_url,alt:"Cover"}),(0,l.jsx)("div",{className:"absolute transition opacity-0 rounded-full flex items-center justify-center bg-green-500 p-4 drop-shadow-md right-2 bottom-2 group-hover:opacity-100 hover:scale-110",children:(0,l.jsx)(O.A,{className:"text-black fill-black"})})]}),(0,l.jsxs)("div",{className:"flex flex-row items-center w-full pt-2 gap-x-3",children:[(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),f.has(e.id)||g(e)},disabled:u===e.id||f.has(e.id),title:f.has(e.id)?"Downloaded":"Download for offline",className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center transition ${f.has(e.id)?"text-green-500 cursor-default":"text-neutral-400 hover:text-white hover:bg-neutral-700"}`,children:u===e.id?(0,l.jsx)("div",{className:"animate-spin text-green-500",children:"⏳"}):f.has(e.id)?(0,l.jsx)(F.A,{size:18}):(0,l.jsx)(E.A,{size:20})}),(0,l.jsxs)("div",{className:"flex flex-col items-start min-w-0 flex-1",children:[(0,l.jsx)("p",{className:"font-semibold truncate w-full text-white text-sm",children:e.title}),(0,l.jsx)("p",{className:"text-neutral-400 text-xs w-full truncate",children:e.artist})]})]})]},e.id))})})]})},_=()=>(0,l.jsx)("div",{className:" bg-neutral-900  rounded-lg  h-full  w-full  overflow-hidden  overflow-y-auto ",children:(0,l.jsx)(o.Suspense,{fallback:(0,l.jsx)("div",{className:"text-white p-6",children:"Loading search..."}),children:(0,l.jsx)(U,{})})})},6962:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},8340:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(2115);let l=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},o=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:s="",children:i,iconNode:c,...u},d)=>(0,a.createElement)("svg",{ref:d,...n,width:t,height:t,stroke:e,strokeWidth:l?24*Number(r)/Number(t):r,className:o("lucide",s),...!i&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(u)&&{"aria-hidden":"true"},...u},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(i)?i:[i]])),i=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...n},i)=>(0,a.createElement)(s,{ref:i,iconNode:t,className:o(`lucide-${l(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...n}));return r.displayName=l(e),r}},9121:(e,t,r)=>{Promise.resolve().then(r.bind(r,5838))},9769:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1934).v)(e=>({activeSong:void 0,isPlaying:!1,volume:1,setSong:t=>e({activeSong:t,isPlaying:!0}),reset:()=>e({activeSong:void 0,isPlaying:!1}),togglePlay:()=>e(e=>({isPlaying:!e.isPlaying})),setVolume:t=>e({volume:t})}))}},e=>{e.O(0,[958,441,794,358],()=>e(e.s=9121)),_N_E=e.O()}]);