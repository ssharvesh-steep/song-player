(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{232:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},1142:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});let s=(0,r(1958).UU)("https://rcofndbwultxfqiwqmst.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjb2ZuZGJ3dWx0eGZxaXdxbXN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5MTk1MDIsImV4cCI6MjA4MjQ5NTUwMn0.pYykBYeJx9_9gu98f1Vi1E_GVoiKhSBNtcr77nxQMmY")},1878:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},1934:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});var s=r(2115);let a=e=>{let t,r=new Set,s=(e,s)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=s?s:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,l={setState:s,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(s,a,l);return l},l=e=>{let t=e?a(e):a,r=e=>(function(e,t=e=>e){let r=s.useSyncExternalStore(e.subscribe,s.useCallback(()=>t(e.getState()),[e,t]),s.useCallback(()=>t(e.getInitialState()),[e,t]));return s.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},i=e=>e?l(e):l},2149:(e,t,r)=>{"use strict";r.d(t,{dU:()=>n,ge:()=>o,o7:()=>l,op:()=>i});let s="downloads",a=()=>new Promise((e,t)=>{let r=indexedDB.open("MusicPlayerDB",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(s)||t.createObjectStore(s,{keyPath:"id"})}}),l=async e=>{try{let t=await fetch(e.audio_url),r=await t.blob(),l=await fetch(e.image_url),i=await l.blob(),n=await a(),o=n.transaction([s],"readwrite").objectStore(s),c={id:e.id,title:e.title,artist:e.artist,image_url:e.image_url,audio_url:e.audio_url,audio_blob:r,image_blob:i,downloaded_at:Date.now()};await new Promise((e,t)=>{let r=o.put(c);r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),n.close()}catch(e){throw console.error("Download error:",e),e}},i=async()=>{try{let e=(await a()).transaction([s],"readonly").objectStore(s);return new Promise((t,r)=>{let s=e.getAll();s.onsuccess=()=>t(s.result),s.onerror=()=>r(s.error)})}catch(e){return console.error("Error getting downloads:",e),[]}},n=async e=>{try{let t=(await a()).transaction([s],"readonly").objectStore(s);return new Promise((r,s)=>{let a=t.get(e);a.onsuccess=()=>r(!!a.result),a.onerror=()=>s(a.error)})}catch(e){return!1}},o=async e=>{try{let t=await a(),r=t.transaction([s],"readwrite").objectStore(s);await new Promise((t,s)=>{let a=r.delete(e);a.onsuccess=()=>t(a.result),a.onerror=()=>s(a.error)}),t.close()}catch(e){throw console.error("Delete error:",e),e}}},3020:(e,t,r)=>{Promise.resolve().then(r.bind(r,6919))},4514:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6919:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(5155),a=r(2115),l=r(1142),i=r(9769),n=r(1878),o=r(232),c=r(4514),d=r(6962),u=r(2149),h=r(9521);function m(){let[e,t]=(0,a.useState)([]),[r,m]=(0,a.useState)(!0),[x,g]=(0,a.useState)(null),[f,b]=(0,a.useState)(new Set),w=(0,i.A)(),{user:p}=(0,h.A)();(0,a.useEffect)(()=>{j();let e=l.N.channel("songs-home-changes").on("postgres_changes",{event:"*",schema:"public",table:"songs"},e=>j()).subscribe();return()=>{l.N.removeChannel(e)}},[]);let j=async()=>{let{data:e,error:r}=await l.N.from("songs").select("*").order("created_at",{ascending:!1});if(!r&&e){let r=e.map(e=>{let t=e.image_url.startsWith("http")?e.image_url:l.N.storage.from("images").getPublicUrl(e.image_url).data.publicUrl,r=e.audio_url.startsWith("http")?e.audio_url:l.N.storage.from("songs").getPublicUrl(e.audio_url).data.publicUrl;return{...e,image_url:t,audio_url:r}});t(r);let s=new Set;for(let e of r)await (0,u.dU)(e.id)&&s.add(e.id);b(s)}m(!1)},v=async e=>{try{g(e.id),await (0,u.o7)(e),b(t=>new Set(t).add(e.id))}catch(e){console.error("Download error:",e),alert("Failed to download song")}finally{g(null)}};return(0,s.jsx)("div",{className:"h-full w-full overflow-hidden overflow-y-auto bg-gray-50/50",children:(0,s.jsxs)("div",{className:"p-6 pb-24",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-neutral-800",children:"Discover"})}),(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-neutral-200 overflow-hidden border-2 border-white shadow-sm",children:p?.email?(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-orange-500 text-white font-bold",children:p.email[0].toUpperCase()}):(0,s.jsx)("div",{className:"w-full h-full bg-neutral-300"})})})]}),(0,s.jsxs)("div",{className:"relative mb-8 shadow-sm",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search artists, songs...",className:"w-full h-12 rounded-xl pl-12 pr-4 bg-white text-neutral-800 placeholder:text-neutral-400 focus:outline-none focus:ring-2 focus:ring-orange-500/50 font-medium",readOnly:!0,onClick:()=>window.location.href="/search"}),(0,s.jsx)(n.A,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-400",size:20})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-neutral-800",children:"New Releases"}),(0,s.jsx)("button",{className:"text-sm font-medium text-neutral-400 hover:text-orange-500",children:"View All"})]}),(0,s.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4 scrollbar-hide mb-6",children:[1,2,3].map(e=>(0,s.jsxs)("div",{className:"min-w-[140px] md:min-w-[180px] space-y-3 cursor-pointer group",children:[(0,s.jsxs)("div",{className:"aspect-square rounded-2xl bg-neutral-200 overflow-hidden relative shadow-md",children:[(0,s.jsx)("div",{className:`w-full h-full bg-gradient-to-br ${1===e?"from-orange-400 to-pink-500":2===e?"from-blue-400 to-purple-500":"from-green-400 to-teal-500"}`}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/30 backdrop-blur-md flex items-center justify-center",children:(0,s.jsx)(o.A,{size:20,className:"fill-white text-white ml-0.5"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-bold text-neutral-800 truncate",children:["Song Title ",e]}),(0,s.jsx)("p",{className:"text-xs text-neutral-500 truncate",children:"Artist Name"})]})]},e))}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-neutral-800 mb-4",children:"For You"}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl p-6 text-white relative overflow-hidden shadow-lg shadow-indigo-500/30 cursor-pointer hover:scale-[1.02] transition",children:[(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)("p",{className:"text-indigo-100 text-sm font-medium mb-1",children:"Weekly Music"}),(0,s.jsx)("h3",{className:"text-2xl font-bold mb-4",children:"Your Weekly Mix"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex -space-x-2",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"w-6 h-6 rounded-full bg-white/20 border border-white/10"},e))}),(0,s.jsx)("span",{className:"text-xs text-indigo-100",children:"+ 40 Tracks"})]})]}),(0,s.jsx)("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-white/10 rounded-full blur-2xl"}),(0,s.jsx)("div",{className:"absolute top-4 right-4 w-12 h-12 bg-white/10 rounded-full blur-xl"})]})]}),(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-neutral-800",children:"Popular Songs"}),(0,s.jsx)("button",{className:"text-sm font-medium text-neutral-400 hover:text-orange-500 transition",children:"Show all"})]}),r?(0,s.jsx)("div",{className:"text-neutral-400 flex justify-center py-10",children:"Loading..."}):(0,s.jsx)("div",{className:"flex flex-col gap-3",children:e.map(e=>(0,s.jsxs)("div",{onClick:()=>w.setSong(e),className:"group flex items-center justify-between p-3 rounded-2xl bg-white hover:bg-orange-50 transition cursor-pointer shadow-sm border border-neutral-100 hover:border-orange-100",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative w-14 h-14 rounded-xl overflow-hidden shadow-sm bg-neutral-100",children:[(0,s.jsx)("img",{className:"object-cover w-full h-full group-hover:scale-110 transition duration-500",src:e.image_url,alt:"Cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/10 flex items-center justify-center opacity-0 group-hover:opacity-100 transition",children:(0,s.jsx)(o.A,{size:16,className:"text-white fill-white"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-neutral-800 truncate",children:e.title}),(0,s.jsx)("p",{className:"text-neutral-500 text-xs font-medium",children:e.artist})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),f.has(e.id)||v(e)},disabled:x===e.id||f.has(e.id),className:`w-9 h-9 rounded-full flex items-center justify-center transition border border-transparent ${f.has(e.id)?"text-orange-500 bg-orange-100":"text-neutral-400 hover:text-orange-500 hover:bg-orange-50"}`,children:x===e.id?(0,s.jsx)("div",{className:"animate-spin text-orange-500 text-xs",children:"â³"}):f.has(e.id)?(0,s.jsx)(c.A,{size:16}):(0,s.jsx)(d.A,{size:16})}),(0,s.jsx)("button",{className:"w-9 h-9 rounded-full flex items-center justify-center text-neutral-400 hover:text-orange-500 hover:bg-orange-50 transition",children:(0,s.jsx)(o.A,{size:16,className:"ml-0.5 fill-current"})})]})]},e.id))})]})})}},6962:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},8340:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:o,iconNode:c,...d},u)=>(0,s.createElement)("svg",{ref:u,...i,width:t,height:t,stroke:e,strokeWidth:a?24*Number(r)/Number(t):r,className:l("lucide",n),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(o)?o:[o]])),o=(e,t)=>{let r=(0,s.forwardRef)(({className:r,...i},o)=>(0,s.createElement)(n,{ref:o,iconNode:t,className:l(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...i}));return r.displayName=a(e),r}},9521:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,AuthProvider:()=>o});var s=r(5155),a=r(2115),l=r(1142);let i=(0,a.createContext)({user:null,loading:!0,signOut:async()=>{}}),n=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e};function o({children:e}){let[t,r]=(0,a.useState)(null),[n,o]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{let{data:{session:e},error:t}=await l.N.auth.getSession();t?(console.error("Auth session error:",t),(t.message.includes("Refresh Token Not Found")||t.message.includes("Invalid Refresh Token"))&&(await l.N.auth.signOut(),r(null))):r(e?.user??null),o(!1)})();let{data:{subscription:e}}=l.N.auth.onAuthStateChange(async(e,t)=>{console.log("Auth event:",e),"SIGNED_OUT"===e?r(null):("SIGNED_IN"===e||"TOKEN_REFRESHED"===e)&&r(t?.user??null),o(!1)});return()=>e.unsubscribe()},[]);let c=async()=>{await l.N.auth.signOut(),r(null)};return(0,s.jsx)(i.Provider,{value:{user:t,loading:n,signOut:c},children:e})}},9769:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1934).v)(e=>({activeSong:void 0,isPlaying:!1,volume:1,setSong:t=>e({activeSong:t,isPlaying:!0}),reset:()=>e({activeSong:void 0,isPlaying:!1}),togglePlay:()=>e(e=>({isPlaying:!e.isPlaying})),setVolume:t=>e({volume:t})}))}},e=>{e.O(0,[958,441,794,358],()=>e(e.s=3020)),_N_E=e.O()}]);